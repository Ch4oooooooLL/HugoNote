<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>FEM å¤ä¹ ï¼š1D å˜æˆªé¢æ†ä»¶åˆ†æ (Python å®ç°) | Chaos Blog</title><meta name=keywords content="FEM,Python,NumericalAnalysis,Structure,Review"><meta name=description content='1. é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹
ç›®æ ‡ï¼šæ±‚è§£ä¸€æ ¹é•¿åº¦ä¸º $L$ã€å¼¹æ€§æ¨¡é‡ä¸º $E$ã€æ¨ªæˆªé¢ç§¯ $A(x)$ éšä½ç½®å˜åŒ–çš„æ†ä»¶ï¼Œåœ¨å³ç«¯å—åˆ°æ‹‰åŠ› $P$ ä½œç”¨ä¸‹çš„ä½ç§»åœº $u(x)$ã€‚
æ§åˆ¶æ–¹ç¨‹ (Strong Form)ï¼š

$$
\frac{d}{dx}\left( E A(x) \frac{du}{dx} \right) = 0, \quad x \in [0, L]
$$
è¾¹ç•Œæ¡ä»¶ï¼š

Dirichlet (æœ¬è´¨è¾¹ç•Œ): $u(0) = 0$ (å·¦ç«¯å›ºå®š)
Neumann (è‡ªç„¶è¾¹ç•Œ): $E A(L) \frac{du}{dx}|_{x=L} = P$ (å³ç«¯å—åŠ›)

æœ‰é™å…ƒç¦»æ•£ (Weak Form)ï¼š
å¯¹äºçº¿æ€§æ†å•å…ƒï¼Œå•å…ƒåˆšåº¦çŸ©é˜µ $k_e$ ä¸ºï¼š

$$
k_e = \frac{EA_{avg}}{L_e} \begin{bmatrix} 1 & -1 \\ -1 & 1 \end{bmatrix}
$$
å…¶ä¸­ $A_{avg}$ å–å•å…ƒä¸­å¿ƒå¤„çš„æˆªé¢é¢ç§¯è¿‘ä¼¼ã€‚
2. ä»£ç å®ç°æ¶æ„
ç¨‹åºæ•´ä½“åˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼š

å‰å¤„ç† (Pre-processing): ç¦»æ•£åŒ–å‡ ä½•åŸŸï¼Œç”ŸæˆèŠ‚ç‚¹ä¸å•å…ƒã€‚
å•å…ƒè®¡ç®— (Element Calculation): è®¡ç®—å±€éƒ¨åˆšåº¦çŸ©é˜µã€‚
ç»„è£… (Assembly): æ„å»ºå…¨å±€åˆšåº¦çŸ©é˜µ $K$ å’Œè½½è·å‘é‡ $F$ã€‚
è¾¹ç•Œå¤„ç† (Boundary Conditions): ä¿®æ­£çŸ©é˜µä»¥å¼•å…¥çº¦æŸã€‚
æ±‚è§£ä¸å¯è§†åŒ– (Solver & Post-processing): è§£æ–¹ç¨‹ç»„å¹¶ç»˜å›¾ã€‚

2.1 åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰
import numpy as np
import matplotlib.pyplot as plt

# === ç‰©ç†å‚æ•° ===
L_total = 10.0      # æ†ä»¶æ€»é•¿åº¦ [m]
P_load  = 1000.0    # æœ«ç«¯æ‹‰åŠ› [N]
E_mod   = 2.1e11    # å¼¹æ€§æ¨¡é‡ [Pa]

# === å‡ ä½•å‚æ•° (å˜æˆªé¢æ¨¡æ‹Ÿ) ===
def get_area(x):
    """
    å®šä¹‰æ¨ªæˆªé¢ç§¯ A éšåæ ‡ x çš„å˜åŒ–å‡½æ•°
    æ­¤å¤„æ¨¡æ‹Ÿé”¥å½¢æ†: æ ¹éƒ¨ 0.01 m^2 -> æœ«ç«¯ 0.005 m^2
    """
    return 0.01 - (0.005 * x / L_total)

# === ç½‘æ ¼æ§åˆ¶ ===
NUM_ELEMENTS = 10                  # å•å…ƒæ•°é‡
NUM_NODES    = NUM_ELEMENTS + 1    # èŠ‚ç‚¹æ•°é‡ (1Dçº¿æ€§å•å…ƒ)
2.2 ç½‘æ ¼ç”Ÿæˆ (Meshing)




  
    
Nodes (Coordinates): å­˜å‚¨ç‰©ç†åæ ‡ã€‚
Connectivity (Topology): å­˜å‚¨èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ã€‚å¯¹äº 1D çº¿æ€§å•å…ƒï¼Œç¬¬ $i$ ä¸ªå•å…ƒè¿æ¥èŠ‚ç‚¹ $i$ å’Œ $i+1$ã€‚

  
# 1. ç”ŸæˆèŠ‚ç‚¹åæ ‡æ•°ç»„
# linspace: ç”Ÿæˆç­‰é—´è·åˆ†å¸ƒçš„èŠ‚ç‚¹
nodes = np.linspace(0, L_total, NUM_NODES)

# 2. ç”Ÿæˆå•å…ƒè¿æ¥è¡¨ (Connectivity Matrix)
# elements[i] = [å·¦èŠ‚ç‚¹ç´¢å¼•, å³èŠ‚ç‚¹ç´¢å¼•]
elements = []
for i in range(NUM_ELEMENTS):
    elements.append([i, i + 1])

# è½¬ä¸º array æ–¹ä¾¿åç»­ç´¢å¼•
elements = np.array(elements)




  
    np.linspace(start, stop, num) ç”ŸæˆåŒ…å« num ä¸ªç‚¹çš„ç­‰å·®æ•°åˆ—ï¼ˆé—­åŒºé—´ï¼‰ã€‚è¿™æ˜¯ FEM ç”Ÿæˆç»“æ„åŒ–ç½‘æ ¼æœ€å¸¸ç”¨çš„å‡½æ•°ã€‚'><meta name=author content><link rel=canonical href=https://example.org/posts/1d%E6%9C%89%E9%99%90%E5%85%83python%E7%A8%8B%E5%BA%8F%E5%A4%8D%E5%BB%BA%E4%B8%8E%E6%B3%A8%E8%A7%A3/><link crossorigin=anonymous href=/assets/css/stylesheet.c782e0688adadd032c468535563c902ebffdb7fcfa61b5ae36f71d57b5924323.css integrity="sha256-x4LgaIra3QMsRoU1VjyQLr/9t/z6YbWuNvcdV7WSQyM=" rel="preload stylesheet" as=style><link rel=icon href=https://example.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://example.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://example.org/favicon-32x32.png><link rel=apple-touch-icon href=https://example.org/apple-touch-icon.png><link rel=mask-icon href=https://example.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://example.org/posts/1d%E6%9C%89%E9%99%90%E5%85%83python%E7%A8%8B%E5%BA%8F%E5%A4%8D%E5%BB%BA%E4%B8%8E%E6%B3%A8%E8%A7%A3/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta property="og:url" content="https://example.org/posts/1d%E6%9C%89%E9%99%90%E5%85%83python%E7%A8%8B%E5%BA%8F%E5%A4%8D%E5%BB%BA%E4%B8%8E%E6%B3%A8%E8%A7%A3/"><meta property="og:site_name" content="Chaos Blog"><meta property="og:title" content="FEM å¤ä¹ ï¼š1D å˜æˆªé¢æ†ä»¶åˆ†æ (Python å®ç°)"><meta property="og:description" content='1. é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹ ç›®æ ‡ï¼šæ±‚è§£ä¸€æ ¹é•¿åº¦ä¸º $L$ã€å¼¹æ€§æ¨¡é‡ä¸º $E$ã€æ¨ªæˆªé¢ç§¯ $A(x)$ éšä½ç½®å˜åŒ–çš„æ†ä»¶ï¼Œåœ¨å³ç«¯å—åˆ°æ‹‰åŠ› $P$ ä½œç”¨ä¸‹çš„ä½ç§»åœº $u(x)$ã€‚
æ§åˆ¶æ–¹ç¨‹ (Strong Form)ï¼š $$ \frac{d}{dx}\left( E A(x) \frac{du}{dx} \right) = 0, \quad x \in [0, L] $$ è¾¹ç•Œæ¡ä»¶ï¼š
Dirichlet (æœ¬è´¨è¾¹ç•Œ): $u(0) = 0$ (å·¦ç«¯å›ºå®š) Neumann (è‡ªç„¶è¾¹ç•Œ): $E A(L) \frac{du}{dx}|_{x=L} = P$ (å³ç«¯å—åŠ›) æœ‰é™å…ƒç¦»æ•£ (Weak Form)ï¼š å¯¹äºçº¿æ€§æ†å•å…ƒï¼Œå•å…ƒåˆšåº¦çŸ©é˜µ $k_e$ ä¸ºï¼š $$ k_e = \frac{EA_{avg}}{L_e} \begin{bmatrix} 1 & -1 \\ -1 & 1 \end{bmatrix} $$ å…¶ä¸­ $A_{avg}$ å–å•å…ƒä¸­å¿ƒå¤„çš„æˆªé¢é¢ç§¯è¿‘ä¼¼ã€‚
2. ä»£ç å®ç°æ¶æ„ ç¨‹åºæ•´ä½“åˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼š
å‰å¤„ç† (Pre-processing): ç¦»æ•£åŒ–å‡ ä½•åŸŸï¼Œç”ŸæˆèŠ‚ç‚¹ä¸å•å…ƒã€‚ å•å…ƒè®¡ç®— (Element Calculation): è®¡ç®—å±€éƒ¨åˆšåº¦çŸ©é˜µã€‚ ç»„è£… (Assembly): æ„å»ºå…¨å±€åˆšåº¦çŸ©é˜µ $K$ å’Œè½½è·å‘é‡ $F$ã€‚ è¾¹ç•Œå¤„ç† (Boundary Conditions): ä¿®æ­£çŸ©é˜µä»¥å¼•å…¥çº¦æŸã€‚ æ±‚è§£ä¸å¯è§†åŒ– (Solver & Post-processing): è§£æ–¹ç¨‹ç»„å¹¶ç»˜å›¾ã€‚ 2.1 åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰ import numpy as np import matplotlib.pyplot as plt # === ç‰©ç†å‚æ•° === L_total = 10.0 # æ†ä»¶æ€»é•¿åº¦ [m] P_load = 1000.0 # æœ«ç«¯æ‹‰åŠ› [N] E_mod = 2.1e11 # å¼¹æ€§æ¨¡é‡ [Pa] # === å‡ ä½•å‚æ•° (å˜æˆªé¢æ¨¡æ‹Ÿ) === def get_area(x): """ å®šä¹‰æ¨ªæˆªé¢ç§¯ A éšåæ ‡ x çš„å˜åŒ–å‡½æ•° æ­¤å¤„æ¨¡æ‹Ÿé”¥å½¢æ†: æ ¹éƒ¨ 0.01 m^2 -> æœ«ç«¯ 0.005 m^2 """ return 0.01 - (0.005 * x / L_total) # === ç½‘æ ¼æ§åˆ¶ === NUM_ELEMENTS = 10 # å•å…ƒæ•°é‡ NUM_NODES = NUM_ELEMENTS + 1 # èŠ‚ç‚¹æ•°é‡ (1Dçº¿æ€§å•å…ƒ) 2.2 ç½‘æ ¼ç”Ÿæˆ (Meshing) Nodes (Coordinates): å­˜å‚¨ç‰©ç†åæ ‡ã€‚ Connectivity (Topology): å­˜å‚¨èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ã€‚å¯¹äº 1D çº¿æ€§å•å…ƒï¼Œç¬¬ $i$ ä¸ªå•å…ƒè¿æ¥èŠ‚ç‚¹ $i$ å’Œ $i+1$ã€‚ # 1. ç”ŸæˆèŠ‚ç‚¹åæ ‡æ•°ç»„ # linspace: ç”Ÿæˆç­‰é—´è·åˆ†å¸ƒçš„èŠ‚ç‚¹ nodes = np.linspace(0, L_total, NUM_NODES) # 2. ç”Ÿæˆå•å…ƒè¿æ¥è¡¨ (Connectivity Matrix) # elements[i] = [å·¦èŠ‚ç‚¹ç´¢å¼•, å³èŠ‚ç‚¹ç´¢å¼•] elements = [] for i in range(NUM_ELEMENTS): elements.append([i, i + 1]) # è½¬ä¸º array æ–¹ä¾¿åç»­ç´¢å¼• elements = np.array(elements) np.linspace(start, stop, num) ç”ŸæˆåŒ…å« num ä¸ªç‚¹çš„ç­‰å·®æ•°åˆ—ï¼ˆé—­åŒºé—´ï¼‰ã€‚è¿™æ˜¯ FEM ç”Ÿæˆç»“æ„åŒ–ç½‘æ ¼æœ€å¸¸ç”¨çš„å‡½æ•°ã€‚'><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:tag" content="FEM"><meta property="article:tag" content="Python"><meta property="article:tag" content="NumericalAnalysis"><meta property="article:tag" content="Structure"><meta property="article:tag" content="Review"><meta name=twitter:card content="summary"><meta name=twitter:title content="FEM å¤ä¹ ï¼š1D å˜æˆªé¢æ†ä»¶åˆ†æ (Python å®ç°)"><meta name=twitter:description content='1. é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹
ç›®æ ‡ï¼šæ±‚è§£ä¸€æ ¹é•¿åº¦ä¸º $L$ã€å¼¹æ€§æ¨¡é‡ä¸º $E$ã€æ¨ªæˆªé¢ç§¯ $A(x)$ éšä½ç½®å˜åŒ–çš„æ†ä»¶ï¼Œåœ¨å³ç«¯å—åˆ°æ‹‰åŠ› $P$ ä½œç”¨ä¸‹çš„ä½ç§»åœº $u(x)$ã€‚
æ§åˆ¶æ–¹ç¨‹ (Strong Form)ï¼š

$$
\frac{d}{dx}\left( E A(x) \frac{du}{dx} \right) = 0, \quad x \in [0, L]
$$
è¾¹ç•Œæ¡ä»¶ï¼š

Dirichlet (æœ¬è´¨è¾¹ç•Œ): $u(0) = 0$ (å·¦ç«¯å›ºå®š)
Neumann (è‡ªç„¶è¾¹ç•Œ): $E A(L) \frac{du}{dx}|_{x=L} = P$ (å³ç«¯å—åŠ›)

æœ‰é™å…ƒç¦»æ•£ (Weak Form)ï¼š
å¯¹äºçº¿æ€§æ†å•å…ƒï¼Œå•å…ƒåˆšåº¦çŸ©é˜µ $k_e$ ä¸ºï¼š

$$
k_e = \frac{EA_{avg}}{L_e} \begin{bmatrix} 1 & -1 \\ -1 & 1 \end{bmatrix}
$$
å…¶ä¸­ $A_{avg}$ å–å•å…ƒä¸­å¿ƒå¤„çš„æˆªé¢é¢ç§¯è¿‘ä¼¼ã€‚
2. ä»£ç å®ç°æ¶æ„
ç¨‹åºæ•´ä½“åˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼š

å‰å¤„ç† (Pre-processing): ç¦»æ•£åŒ–å‡ ä½•åŸŸï¼Œç”ŸæˆèŠ‚ç‚¹ä¸å•å…ƒã€‚
å•å…ƒè®¡ç®— (Element Calculation): è®¡ç®—å±€éƒ¨åˆšåº¦çŸ©é˜µã€‚
ç»„è£… (Assembly): æ„å»ºå…¨å±€åˆšåº¦çŸ©é˜µ $K$ å’Œè½½è·å‘é‡ $F$ã€‚
è¾¹ç•Œå¤„ç† (Boundary Conditions): ä¿®æ­£çŸ©é˜µä»¥å¼•å…¥çº¦æŸã€‚
æ±‚è§£ä¸å¯è§†åŒ– (Solver & Post-processing): è§£æ–¹ç¨‹ç»„å¹¶ç»˜å›¾ã€‚

2.1 åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰
import numpy as np
import matplotlib.pyplot as plt

# === ç‰©ç†å‚æ•° ===
L_total = 10.0      # æ†ä»¶æ€»é•¿åº¦ [m]
P_load  = 1000.0    # æœ«ç«¯æ‹‰åŠ› [N]
E_mod   = 2.1e11    # å¼¹æ€§æ¨¡é‡ [Pa]

# === å‡ ä½•å‚æ•° (å˜æˆªé¢æ¨¡æ‹Ÿ) ===
def get_area(x):
    """
    å®šä¹‰æ¨ªæˆªé¢ç§¯ A éšåæ ‡ x çš„å˜åŒ–å‡½æ•°
    æ­¤å¤„æ¨¡æ‹Ÿé”¥å½¢æ†: æ ¹éƒ¨ 0.01 m^2 -> æœ«ç«¯ 0.005 m^2
    """
    return 0.01 - (0.005 * x / L_total)

# === ç½‘æ ¼æ§åˆ¶ ===
NUM_ELEMENTS = 10                  # å•å…ƒæ•°é‡
NUM_NODES    = NUM_ELEMENTS + 1    # èŠ‚ç‚¹æ•°é‡ (1Dçº¿æ€§å•å…ƒ)
2.2 ç½‘æ ¼ç”Ÿæˆ (Meshing)




  
    
Nodes (Coordinates): å­˜å‚¨ç‰©ç†åæ ‡ã€‚
Connectivity (Topology): å­˜å‚¨èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ã€‚å¯¹äº 1D çº¿æ€§å•å…ƒï¼Œç¬¬ $i$ ä¸ªå•å…ƒè¿æ¥èŠ‚ç‚¹ $i$ å’Œ $i+1$ã€‚

  
# 1. ç”ŸæˆèŠ‚ç‚¹åæ ‡æ•°ç»„
# linspace: ç”Ÿæˆç­‰é—´è·åˆ†å¸ƒçš„èŠ‚ç‚¹
nodes = np.linspace(0, L_total, NUM_NODES)

# 2. ç”Ÿæˆå•å…ƒè¿æ¥è¡¨ (Connectivity Matrix)
# elements[i] = [å·¦èŠ‚ç‚¹ç´¢å¼•, å³èŠ‚ç‚¹ç´¢å¼•]
elements = []
for i in range(NUM_ELEMENTS):
    elements.append([i, i + 1])

# è½¬ä¸º array æ–¹ä¾¿åç»­ç´¢å¼•
elements = np.array(elements)




  
    np.linspace(start, stop, num) ç”ŸæˆåŒ…å« num ä¸ªç‚¹çš„ç­‰å·®æ•°åˆ—ï¼ˆé—­åŒºé—´ï¼‰ã€‚è¿™æ˜¯ FEM ç”Ÿæˆç»“æ„åŒ–ç½‘æ ¼æœ€å¸¸ç”¨çš„å‡½æ•°ã€‚'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://example.org/posts/"},{"@type":"ListItem","position":2,"name":"FEM å¤ä¹ ï¼š1D å˜æˆªé¢æ†ä»¶åˆ†æ (Python å®ç°)","item":"https://example.org/posts/1d%E6%9C%89%E9%99%90%E5%85%83python%E7%A8%8B%E5%BA%8F%E5%A4%8D%E5%BB%BA%E4%B8%8E%E6%B3%A8%E8%A7%A3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"FEM å¤ä¹ ï¼š1D å˜æˆªé¢æ†ä»¶åˆ†æ (Python å®ç°)","name":"FEM å¤ä¹ ï¼š1D å˜æˆªé¢æ†ä»¶åˆ†æ (Python å®ç°)","description":"1. é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹ ç›®æ ‡ï¼šæ±‚è§£ä¸€æ ¹é•¿åº¦ä¸º $L$ã€å¼¹æ€§æ¨¡é‡ä¸º $E$ã€æ¨ªæˆªé¢ç§¯ $A(x)$ éšä½ç½®å˜åŒ–çš„æ†ä»¶ï¼Œåœ¨å³ç«¯å—åˆ°æ‹‰åŠ› $P$ ä½œç”¨ä¸‹çš„ä½ç§»åœº $u(x)$ã€‚\næ§åˆ¶æ–¹ç¨‹ (Strong Form)ï¼š $$ \\frac{d}{dx}\\left( E A(x) \\frac{du}{dx} \\right) = 0, \\quad x \\in [0, L] $$ è¾¹ç•Œæ¡ä»¶ï¼š\nDirichlet (æœ¬è´¨è¾¹ç•Œ): $u(0) = 0$ (å·¦ç«¯å›ºå®š) Neumann (è‡ªç„¶è¾¹ç•Œ): $E A(L) \\frac{du}{dx}|_{x=L} = P$ (å³ç«¯å—åŠ›) æœ‰é™å…ƒç¦»æ•£ (Weak Form)ï¼š å¯¹äºçº¿æ€§æ†å•å…ƒï¼Œå•å…ƒåˆšåº¦çŸ©é˜µ $k_e$ ä¸ºï¼š $$ k_e = \\frac{EA_{avg}}{L_e} \\begin{bmatrix} 1 \u0026 -1 \\\\ -1 \u0026 1 \\end{bmatrix} $$ å…¶ä¸­ $A_{avg}$ å–å•å…ƒä¸­å¿ƒå¤„çš„æˆªé¢é¢ç§¯è¿‘ä¼¼ã€‚\n2. ä»£ç å®ç°æ¶æ„ ç¨‹åºæ•´ä½“åˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼š\nå‰å¤„ç† (Pre-processing): ç¦»æ•£åŒ–å‡ ä½•åŸŸï¼Œç”ŸæˆèŠ‚ç‚¹ä¸å•å…ƒã€‚ å•å…ƒè®¡ç®— (Element Calculation): è®¡ç®—å±€éƒ¨åˆšåº¦çŸ©é˜µã€‚ ç»„è£… (Assembly): æ„å»ºå…¨å±€åˆšåº¦çŸ©é˜µ $K$ å’Œè½½è·å‘é‡ $F$ã€‚ è¾¹ç•Œå¤„ç† (Boundary Conditions): ä¿®æ­£çŸ©é˜µä»¥å¼•å…¥çº¦æŸã€‚ æ±‚è§£ä¸å¯è§†åŒ– (Solver \u0026amp; Post-processing): è§£æ–¹ç¨‹ç»„å¹¶ç»˜å›¾ã€‚ 2.1 åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰ import numpy as np import matplotlib.pyplot as plt # === ç‰©ç†å‚æ•° === L_total = 10.0 # æ†ä»¶æ€»é•¿åº¦ [m] P_load = 1000.0 # æœ«ç«¯æ‹‰åŠ› [N] E_mod = 2.1e11 # å¼¹æ€§æ¨¡é‡ [Pa] # === å‡ ä½•å‚æ•° (å˜æˆªé¢æ¨¡æ‹Ÿ) === def get_area(x): \u0026#34;\u0026#34;\u0026#34; å®šä¹‰æ¨ªæˆªé¢ç§¯ A éšåæ ‡ x çš„å˜åŒ–å‡½æ•° æ­¤å¤„æ¨¡æ‹Ÿé”¥å½¢æ†: æ ¹éƒ¨ 0.01 m^2 -\u0026gt; æœ«ç«¯ 0.005 m^2 \u0026#34;\u0026#34;\u0026#34; return 0.01 - (0.005 * x / L_total) # === ç½‘æ ¼æ§åˆ¶ === NUM_ELEMENTS = 10 # å•å…ƒæ•°é‡ NUM_NODES = NUM_ELEMENTS + 1 # èŠ‚ç‚¹æ•°é‡ (1Dçº¿æ€§å•å…ƒ) 2.2 ç½‘æ ¼ç”Ÿæˆ (Meshing) Nodes (Coordinates): å­˜å‚¨ç‰©ç†åæ ‡ã€‚ Connectivity (Topology): å­˜å‚¨èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ã€‚å¯¹äº 1D çº¿æ€§å•å…ƒï¼Œç¬¬ $i$ ä¸ªå•å…ƒè¿æ¥èŠ‚ç‚¹ $i$ å’Œ $i+1$ã€‚ # 1. ç”ŸæˆèŠ‚ç‚¹åæ ‡æ•°ç»„ # linspace: ç”Ÿæˆç­‰é—´è·åˆ†å¸ƒçš„èŠ‚ç‚¹ nodes = np.linspace(0, L_total, NUM_NODES) # 2. ç”Ÿæˆå•å…ƒè¿æ¥è¡¨ (Connectivity Matrix) # elements[i] = [å·¦èŠ‚ç‚¹ç´¢å¼•, å³èŠ‚ç‚¹ç´¢å¼•] elements = [] for i in range(NUM_ELEMENTS): elements.append([i, i + 1]) # è½¬ä¸º array æ–¹ä¾¿åç»­ç´¢å¼• elements = np.array(elements) np.linspace(start, stop, num) ç”ŸæˆåŒ…å« num ä¸ªç‚¹çš„ç­‰å·®æ•°åˆ—ï¼ˆé—­åŒºé—´ï¼‰ã€‚è¿™æ˜¯ FEM ç”Ÿæˆç»“æ„åŒ–ç½‘æ ¼æœ€å¸¸ç”¨çš„å‡½æ•°ã€‚\n","keywords":["FEM","Python","NumericalAnalysis","Structure","Review"],"articleBody":"1. é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹ ç›®æ ‡ï¼šæ±‚è§£ä¸€æ ¹é•¿åº¦ä¸º $L$ã€å¼¹æ€§æ¨¡é‡ä¸º $E$ã€æ¨ªæˆªé¢ç§¯ $A(x)$ éšä½ç½®å˜åŒ–çš„æ†ä»¶ï¼Œåœ¨å³ç«¯å—åˆ°æ‹‰åŠ› $P$ ä½œç”¨ä¸‹çš„ä½ç§»åœº $u(x)$ã€‚\næ§åˆ¶æ–¹ç¨‹ (Strong Form)ï¼š $$ \\frac{d}{dx}\\left( E A(x) \\frac{du}{dx} \\right) = 0, \\quad x \\in [0, L] $$ è¾¹ç•Œæ¡ä»¶ï¼š\nDirichlet (æœ¬è´¨è¾¹ç•Œ): $u(0) = 0$ (å·¦ç«¯å›ºå®š) Neumann (è‡ªç„¶è¾¹ç•Œ): $E A(L) \\frac{du}{dx}|_{x=L} = P$ (å³ç«¯å—åŠ›) æœ‰é™å…ƒç¦»æ•£ (Weak Form)ï¼š å¯¹äºçº¿æ€§æ†å•å…ƒï¼Œå•å…ƒåˆšåº¦çŸ©é˜µ $k_e$ ä¸ºï¼š $$ k_e = \\frac{EA_{avg}}{L_e} \\begin{bmatrix} 1 \u0026 -1 \\\\ -1 \u0026 1 \\end{bmatrix} $$ å…¶ä¸­ $A_{avg}$ å–å•å…ƒä¸­å¿ƒå¤„çš„æˆªé¢é¢ç§¯è¿‘ä¼¼ã€‚\n2. ä»£ç å®ç°æ¶æ„ ç¨‹åºæ•´ä½“åˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼š\nå‰å¤„ç† (Pre-processing): ç¦»æ•£åŒ–å‡ ä½•åŸŸï¼Œç”ŸæˆèŠ‚ç‚¹ä¸å•å…ƒã€‚ å•å…ƒè®¡ç®— (Element Calculation): è®¡ç®—å±€éƒ¨åˆšåº¦çŸ©é˜µã€‚ ç»„è£… (Assembly): æ„å»ºå…¨å±€åˆšåº¦çŸ©é˜µ $K$ å’Œè½½è·å‘é‡ $F$ã€‚ è¾¹ç•Œå¤„ç† (Boundary Conditions): ä¿®æ­£çŸ©é˜µä»¥å¼•å…¥çº¦æŸã€‚ æ±‚è§£ä¸å¯è§†åŒ– (Solver \u0026 Post-processing): è§£æ–¹ç¨‹ç»„å¹¶ç»˜å›¾ã€‚ 2.1 åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰ import numpy as np import matplotlib.pyplot as plt # === ç‰©ç†å‚æ•° === L_total = 10.0 # æ†ä»¶æ€»é•¿åº¦ [m] P_load = 1000.0 # æœ«ç«¯æ‹‰åŠ› [N] E_mod = 2.1e11 # å¼¹æ€§æ¨¡é‡ [Pa] # === å‡ ä½•å‚æ•° (å˜æˆªé¢æ¨¡æ‹Ÿ) === def get_area(x): \"\"\" å®šä¹‰æ¨ªæˆªé¢ç§¯ A éšåæ ‡ x çš„å˜åŒ–å‡½æ•° æ­¤å¤„æ¨¡æ‹Ÿé”¥å½¢æ†: æ ¹éƒ¨ 0.01 m^2 -\u003e æœ«ç«¯ 0.005 m^2 \"\"\" return 0.01 - (0.005 * x / L_total) # === ç½‘æ ¼æ§åˆ¶ === NUM_ELEMENTS = 10 # å•å…ƒæ•°é‡ NUM_NODES = NUM_ELEMENTS + 1 # èŠ‚ç‚¹æ•°é‡ (1Dçº¿æ€§å•å…ƒ) 2.2 ç½‘æ ¼ç”Ÿæˆ (Meshing) Nodes (Coordinates): å­˜å‚¨ç‰©ç†åæ ‡ã€‚ Connectivity (Topology): å­˜å‚¨èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ã€‚å¯¹äº 1D çº¿æ€§å•å…ƒï¼Œç¬¬ $i$ ä¸ªå•å…ƒè¿æ¥èŠ‚ç‚¹ $i$ å’Œ $i+1$ã€‚ # 1. ç”ŸæˆèŠ‚ç‚¹åæ ‡æ•°ç»„ # linspace: ç”Ÿæˆç­‰é—´è·åˆ†å¸ƒçš„èŠ‚ç‚¹ nodes = np.linspace(0, L_total, NUM_NODES) # 2. ç”Ÿæˆå•å…ƒè¿æ¥è¡¨ (Connectivity Matrix) # elements[i] = [å·¦èŠ‚ç‚¹ç´¢å¼•, å³èŠ‚ç‚¹ç´¢å¼•] elements = [] for i in range(NUM_ELEMENTS): elements.append([i, i + 1]) # è½¬ä¸º array æ–¹ä¾¿åç»­ç´¢å¼• elements = np.array(elements) np.linspace(start, stop, num) ç”ŸæˆåŒ…å« num ä¸ªç‚¹çš„ç­‰å·®æ•°åˆ—ï¼ˆé—­åŒºé—´ï¼‰ã€‚è¿™æ˜¯ FEM ç”Ÿæˆç»“æ„åŒ–ç½‘æ ¼æœ€å¸¸ç”¨çš„å‡½æ•°ã€‚\n2.3 å•å…ƒåˆšåº¦çŸ©é˜µä¸å…¨å±€ç»„è£… æ­¤éƒ¨åˆ†æ˜¯ FEM ç®—æ³•æ ¸å¿ƒã€‚\nå±€éƒ¨è¿‘ä¼¼: å‡å®šå•å…ƒå†…éƒ¨å±æ€§å‡åŒ€ï¼Œå–ä¸­ç‚¹é¢ç§¯ $A_{mid}$ è®¡ç®— $k_e$ã€‚ è‡ªç”±åº¦æ˜ å°„ (DOF Mapping): å±€éƒ¨ç´¢å¼• 0 (å·¦) $\\rightarrow$ å…¨å±€ç´¢å¼• node_i å±€éƒ¨ç´¢å¼• 1 (å³) $\\rightarrow$ å…¨å±€ç´¢å¼• node_j ç´¯åŠ : å…¨å±€çŸ©é˜µ $K_{global}$ çš„å¯¹åº”ä½ç½®ç´¯åŠ å±€éƒ¨çŸ©é˜µçš„åˆ†é‡ã€‚ # åˆå§‹åŒ–å…¨å±€çŸ©é˜µ (ä½¿ç”¨ç¨ å¯†çŸ©é˜µï¼Œå¤§è§„æ¨¡é—®é¢˜éœ€æ”¹ç”¨ scipy.sparse) K_global = np.zeros((NUM_NODES, NUM_NODES)) F_global = np.zeros(NUM_NODES) print(\"å¼€å§‹ç»„è£…åˆšåº¦çŸ©é˜µ...\") for e in range(NUM_ELEMENTS): # --- Step 1: è·å–æ‹“æ‰‘ä¿¡æ¯ --- # è·å–å½“å‰å•å…ƒè¿æ¥çš„å…¨å±€èŠ‚ç‚¹ç´¢å¼• idx_L = elements[e, 0] # å·¦èŠ‚ç‚¹ Global ID idx_R = elements[e, 1] # å³èŠ‚ç‚¹ Global ID # è·å–èŠ‚ç‚¹ç‰©ç†åæ ‡ x_L = nodes[idx_L] x_R = nodes[idx_R] # --- Step 2: è®¡ç®—å•å…ƒåˆšåº¦çŸ©é˜µ k_e --- # å•å…ƒé•¿åº¦ Le = x_R - x_L # å•å…ƒä¸­ç‚¹åæ ‡ -\u003e è®¡ç®—ä¸­ç‚¹é¢ç§¯ (å˜æˆªé¢è¿‘ä¼¼å¤„ç†) x_mid = (x_L + x_R) / 2.0 A_avg = get_area(x_mid) # åˆšåº¦ç³»æ•° k = EA/L k_val = E_mod * A_avg / Le # å±€éƒ¨åˆšåº¦çŸ©é˜µ (2x2) # [ k, -k] # [-k, k] k_element = k_val * np.array([[1, -1], [-1, 1]]) # --- Step 3: ç»„è£…åˆ°å…¨å±€çŸ©é˜µ (Scatter) --- # æ˜ å°„å…³ç³»: # local [0, 0] -\u003e global [idx_L, idx_L] # local [0, 1] -\u003e global [idx_L, idx_R] ... K_global[idx_L, idx_L] += k_element[0, 0] K_global[idx_L, idx_R] += k_element[0, 1] K_global[idx_R, idx_L] += k_element[1, 0] K_global[idx_R, idx_R] += k_element[1, 1] print(\"ç»„è£…å®Œæˆã€‚\") 2.4 æ–½åŠ è¾¹ç•Œæ¡ä»¶ (Boundary Conditions) åŸå§‹ $K_{global}$ æ˜¯å¥‡å¼‚çŸ©é˜µï¼ˆè¡Œåˆ—å¼ä¸º 0ï¼‰ï¼Œä»£è¡¨ç»“æ„å­˜åœ¨åˆšä½“ä½ç§»æ¨¡å¼ã€‚å¿…é¡»å¼•å…¥ Dirichlet è¾¹ç•Œæ¡ä»¶æ‰èƒ½æ±‚è§£ã€‚\nç›®æ ‡ï¼šå¼ºåˆ¶ $u_{node} = \\bar{u}$ã€‚ æ“ä½œï¼š\nå°† $K$ ä¸­å¯¹åº” è¡Œ å…¨éƒ¨ç½®é›¶ã€‚ å°†å¯¹è§’çº¿å…ƒç´  $K_{ii}$ ç½®ä¸º 1ã€‚ å°† $F$ ä¸­å¯¹åº”å…ƒç´  $F_i$ ç½®ä¸º $\\bar{u}$ã€‚ æ³¨ï¼šä¸ºäº†ä¿æŒå¯¹ç§°æ€§ï¼Œé€šå¸¸ä¹Ÿå¯å°†å¯¹åº” åˆ— ç½®é›¶ï¼Œä½†è¿™æ­¥å¯¹äºéå¯¹ç§°æ±‚è§£å™¨ä¸æ˜¯å¿…é¡»çš„ã€‚ # å¤åˆ¶çŸ©é˜µä»¥ä¿ç•™åŸå§‹æ•°æ®ï¼ˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼‰ K_final = K_global.copy() F_final = F_global.copy() # 1. æ–½åŠ  Neumann è¾¹ç•Œ (åŠ›è¾¹ç•Œ) # åœ¨æœ€å³ç«¯èŠ‚ç‚¹ (ç´¢å¼• -1) æ–½åŠ æ‹‰åŠ› P F_final[-1] += P_load # 2. æ–½åŠ  Dirichlet è¾¹ç•Œ (ä½ç§»è¾¹ç•Œ) # çº¦æŸ: å·¦ç«¯èŠ‚ç‚¹ (ç´¢å¼• 0) ä½ç§»ä¸º 0 fixed_node = 0 fixed_val = 0.0 # (1) è¡Œæ¸…é›¶ K_final[fixed_node, :] = 0.0 # (2) å¯¹è§’çº¿ç½®1 K_final[fixed_node, fixed_node] = 1.0 # (3) ä¿®æ­£è½½è·é¡¹ F_final[fixed_node] = fixed_val # (å¯é€‰) å¯¹ç§°åŒ–å¤„ç†ï¼šåˆ—æ¸…é›¶ # æ³¨æ„ï¼šè‹¥æ‰§è¡Œåˆ—æ¸…é›¶ï¼Œéœ€ä¿®æ­£ RHS å‘é‡ä¸­å—è¯¥èŠ‚ç‚¹å½±å“çš„å…¶ä»–é¡¹ # F_final -= K_global[:, fixed_node] * fixed_val # ä½†ç”±äºæ­¤å¤„ fixed_val=0ï¼Œæ­¤æ­¥å¯çœç•¥ã€‚ array[i, :] = 0 è¡¨ç¤ºå°†ç¬¬ i è¡Œçš„æ‰€æœ‰åˆ—å…ƒç´ èµ‹å€¼ä¸º 0ã€‚è¿™æ˜¯ Numpy è¿›è¡ŒçŸ©é˜µæ“ä½œçš„æ ¸å¿ƒè¯­æ³•ã€‚\n2.5 æ±‚è§£ä¸åå¤„ç† # === æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ Ax = b === # U ä¸ºä½ç§»å‘é‡ U = np.linalg.solve(K_final, F_final) # === ç†è®ºè§£å¯¹æ¯” (Exact Solution) === # å¯¹äºå˜æˆªé¢æ†ï¼Œç†è®ºè§£éœ€ç§¯åˆ†: u(x) = Integral(P / (E*A(x)) dx) # ç®€å•çš„æ•°å€¼ç§¯åˆ†ç”¨äºå¯¹æ¯” x_fine = np.linspace(0, L_total, 100) u_exact = np.zeros_like(x_fine) for i in range(1, len(x_fine)): # ç®€å•çš„æ¢¯å½¢ç§¯åˆ† x_seg = x_fine[i] # è¿‘ä¼¼è®¡ç®— u = Integral(P/EA) # è¿™é‡Œä»…åšç²—ç•¥å¯¹æ¯”ç¤ºæ„ dx = x_fine[i] - x_fine[i-1] mid_A = get_area((x_fine[i] + x_fine[i-1])/2) du = (P_load / (E_mod * mid_A)) * dx u_exact[i] = u_exact[i-1] + du # === ç»˜å›¾ === plt.figure(figsize=(10, 6)) # ç»˜åˆ¶ FEM ç»“æœ plt.plot(nodes, U, 'o-', label='FEM (Numerical)', linewidth=2, markersize=8) # ç»˜åˆ¶ç†è®ºè¿‘ä¼¼ plt.plot(x_fine, u_exact, 'r--', label='Theoretical (Approx)', alpha=0.7) plt.title(f'1D Variable Cross-section Bar Analysis\\nElements: {NUM_ELEMENTS}') plt.xlabel('Position x [m]') plt.ylabel('Displacement u [m]') plt.grid(True, which='both', linestyle='--', alpha=0.6) plt.legend() plt.tight_layout() plt.show() print(f\"æœ€å¤§ä½ç§» (FEM): {U[-1]:.6e} m\") 3. å¤ä¹ è¦ç‚¹æ€»ç»“ 3.1 æ ¸å¿ƒç®—æ³•å¤ç›˜ ç¦»æ•£åŒ–ï¼šè¿ç»­ $\\rightarrow$ ç¦»æ•£ (linspace, connectivity)ã€‚ å±€éƒ¨åˆšåº¦ï¼š$k = \\frac{EA}{L}$ï¼Œç‰©ç†å±æ€§åœ¨æ­¤å¤„é€šè¿‡ $A(x)$ å‡½æ•°ç¦»æ•£åŒ–ã€‚ ç»„è£…æ˜ å°„ï¼šè¿™æ˜¯ FEM ç¼–ç¨‹æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ã€‚å¿…é¡»æ¸…æ¥šå±€éƒ¨ç´¢å¼•ï¼ˆ0,1ï¼‰å¦‚ä½•å¯¹åº”åˆ°å…¨å±€ç´¢å¼•ï¼ˆ$i, i+1$ï¼‰ã€‚ è¾¹ç•Œå¤„ç†ï¼šç†è§£ä¸ºä»€ä¹ˆ $K$ æ˜¯å¥‡å¼‚çš„ï¼Œä»¥åŠç½® 1 æ³•å¦‚ä½•é€šè¿‡æ•°å­¦æ‰‹æ®µæ¶ˆé™¤åˆšä½“ä½ç§»ã€‚ 3.2 Python ç§‘å­¦è®¡ç®—è¯­æ³•é€ŸæŸ¥ è¯­æ³• è¯´æ˜ ç¤ºä¾‹ np.zeros((n, m)) åˆå§‹åŒ–å…¨é›¶çŸ©é˜µ K = np.zeros((5,5)) np.linspace(a, b, n) ç”Ÿæˆç­‰å·®æ•°åˆ— ç½‘æ ¼èŠ‚ç‚¹ç”Ÿæˆ enumerate(list) éå†åˆ—è¡¨åŒæ—¶è·å–ç´¢å¼• for i, val in enumerate(nodes): array[-1] ç´¢å¼•å€’æ•°ç¬¬ä¸€ä¸ªå…ƒç´  è·å–æœ«ç«¯èŠ‚ç‚¹ array.copy() æ·±æ‹·è´ K_bc = K.copy() (ç›´æ¥èµ‹å€¼æ˜¯å¼•ç”¨ï¼Œä¿®æ”¹ä¼šå½±å“åŸæ•°ç»„) np.linalg.solve è§£çº¿æ€§æ–¹ç¨‹ç»„ x = solve(A, b) (å†…éƒ¨ä½¿ç”¨ LAPACKï¼Œé«˜æ•ˆ) ","wordCount":"730","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://example.org/posts/1d%E6%9C%89%E9%99%90%E5%85%83python%E7%A8%8B%E5%BA%8F%E5%A4%8D%E5%BB%BA%E4%B8%8E%E6%B3%A8%E8%A7%A3/"},"publisher":{"@type":"Organization","name":"Chaos Blog","logo":{"@type":"ImageObject","url":"https://example.org/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://example.org/ accesskey=h title="Chaos Blog (Alt + H)">Chaos Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://example.org/search/ title="ğŸ” æœç´¢ (Alt + /)" accesskey=/><span>ğŸ” æœç´¢</span></a></li><li><a href=https://example.org/archive/ title="ğŸ—„ï¸ å½’æ¡£"><span>ğŸ—„ï¸ å½’æ¡£</span></a></li><li><a href=https://example.org/categories/ title="ğŸ—‚ï¸ åˆ†ç±»"><span>ğŸ—‚ï¸ åˆ†ç±»</span></a></li><li><a href=https://example.org/tags/ title="ğŸ·ï¸ æ ‡ç­¾"><span>ğŸ·ï¸ æ ‡ç­¾</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">FEM å¤ä¹ ï¼š1D å˜æˆªé¢æ†ä»¶åˆ†æ (Python å®ç°)</h1><div class=post-meta></div></header><div class=post-content><h2 id=1-é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹>1. é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹<a hidden class=anchor aria-hidden=true href=#1-é—®é¢˜å®šä¹‰ä¸ç‰©ç†æ¨¡å‹>#</a></h2><p><strong>ç›®æ ‡</strong>ï¼šæ±‚è§£ä¸€æ ¹é•¿åº¦ä¸º $L$ã€å¼¹æ€§æ¨¡é‡ä¸º $E$ã€æ¨ªæˆªé¢ç§¯ $A(x)$ éšä½ç½®å˜åŒ–çš„æ†ä»¶ï¼Œåœ¨å³ç«¯å—åˆ°æ‹‰åŠ› $P$ ä½œç”¨ä¸‹çš„ä½ç§»åœº $u(x)$ã€‚</p><p><strong>æ§åˆ¶æ–¹ç¨‹ (Strong Form)</strong>ï¼š</p>$$
\frac{d}{dx}\left( E A(x) \frac{du}{dx} \right) = 0, \quad x \in [0, L]
$$<p><strong>è¾¹ç•Œæ¡ä»¶</strong>ï¼š</p><ol><li>Dirichlet (æœ¬è´¨è¾¹ç•Œ): $u(0) = 0$ (å·¦ç«¯å›ºå®š)</li><li>Neumann (è‡ªç„¶è¾¹ç•Œ): $E A(L) \frac{du}{dx}|_{x=L} = P$ (å³ç«¯å—åŠ›)</li></ol><p><strong>æœ‰é™å…ƒç¦»æ•£ (Weak Form)</strong>ï¼š
å¯¹äºçº¿æ€§æ†å•å…ƒï¼Œå•å…ƒåˆšåº¦çŸ©é˜µ $k_e$ ä¸ºï¼š</p>$$
k_e = \frac{EA_{avg}}{L_e} \begin{bmatrix} 1 & -1 \\ -1 & 1 \end{bmatrix}
$$<p>å…¶ä¸­ $A_{avg}$ å–å•å…ƒä¸­å¿ƒå¤„çš„æˆªé¢é¢ç§¯è¿‘ä¼¼ã€‚</p><h2 id=2-ä»£ç å®ç°æ¶æ„>2. ä»£ç å®ç°æ¶æ„<a hidden class=anchor aria-hidden=true href=#2-ä»£ç å®ç°æ¶æ„>#</a></h2><p>ç¨‹åºæ•´ä½“åˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼š</p><ol><li><strong>å‰å¤„ç† (Pre-processing)</strong>: ç¦»æ•£åŒ–å‡ ä½•åŸŸï¼Œç”ŸæˆèŠ‚ç‚¹ä¸å•å…ƒã€‚</li><li><strong>å•å…ƒè®¡ç®— (Element Calculation)</strong>: è®¡ç®—å±€éƒ¨åˆšåº¦çŸ©é˜µã€‚</li><li><strong>ç»„è£… (Assembly)</strong>: æ„å»ºå…¨å±€åˆšåº¦çŸ©é˜µ $K$ å’Œè½½è·å‘é‡ $F$ã€‚</li><li><strong>è¾¹ç•Œå¤„ç† (Boundary Conditions)</strong>: ä¿®æ­£çŸ©é˜µä»¥å¼•å…¥çº¦æŸã€‚</li><li><strong>æ±‚è§£ä¸å¯è§†åŒ– (Solver & Post-processing)</strong>: è§£æ–¹ç¨‹ç»„å¹¶ç»˜å›¾ã€‚</li></ol><h3 id=21-åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰>2.1 åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰<a hidden class=anchor aria-hidden=true href=#21-åˆå§‹åŒ–ä¸å‚æ•°å®šä¹‰>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># === ç‰©ç†å‚æ•° ===</span>
</span></span><span style=display:flex><span>L_total <span style=color:#f92672>=</span> <span style=color:#ae81ff>10.0</span>      <span style=color:#75715e># æ†ä»¶æ€»é•¿åº¦ [m]</span>
</span></span><span style=display:flex><span>P_load  <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000.0</span>    <span style=color:#75715e># æœ«ç«¯æ‹‰åŠ› [N]</span>
</span></span><span style=display:flex><span>E_mod   <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.1e11</span>    <span style=color:#75715e># å¼¹æ€§æ¨¡é‡ [Pa]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># === å‡ ä½•å‚æ•° (å˜æˆªé¢æ¨¡æ‹Ÿ) ===</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_area</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    å®šä¹‰æ¨ªæˆªé¢ç§¯ A éšåæ ‡ x çš„å˜åŒ–å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    æ­¤å¤„æ¨¡æ‹Ÿé”¥å½¢æ†: æ ¹éƒ¨ 0.01 m^2 -&gt; æœ«ç«¯ 0.005 m^2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0.01</span> <span style=color:#f92672>-</span> (<span style=color:#ae81ff>0.005</span> <span style=color:#f92672>*</span> x <span style=color:#f92672>/</span> L_total)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># === ç½‘æ ¼æ§åˆ¶ ===</span>
</span></span><span style=display:flex><span>NUM_ELEMENTS <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>                  <span style=color:#75715e># å•å…ƒæ•°é‡</span>
</span></span><span style=display:flex><span>NUM_NODES    <span style=color:#f92672>=</span> NUM_ELEMENTS <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>    <span style=color:#75715e># èŠ‚ç‚¹æ•°é‡ (1Dçº¿æ€§å•å…ƒ)</span>
</span></span></code></pre></div><h3 id=22-ç½‘æ ¼ç”Ÿæˆ-meshing>2.2 ç½‘æ ¼ç”Ÿæˆ (Meshing)<a hidden class=anchor aria-hidden=true href=#22-ç½‘æ ¼ç”Ÿæˆ-meshing>#</a></h3><blockquote><ul><li><strong>Nodes (Coordinates)</strong>: å­˜å‚¨ç‰©ç†åæ ‡ã€‚</li><li><strong>Connectivity (Topology)</strong>: å­˜å‚¨èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ã€‚å¯¹äº 1D çº¿æ€§å•å…ƒï¼Œç¬¬ $i$ ä¸ªå•å…ƒè¿æ¥èŠ‚ç‚¹ $i$ å’Œ $i+1$ã€‚</li></ul></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 1. ç”ŸæˆèŠ‚ç‚¹åæ ‡æ•°ç»„</span>
</span></span><span style=display:flex><span><span style=color:#75715e># linspace: ç”Ÿæˆç­‰é—´è·åˆ†å¸ƒçš„èŠ‚ç‚¹</span>
</span></span><span style=display:flex><span>nodes <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, L_total, NUM_NODES)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. ç”Ÿæˆå•å…ƒè¿æ¥è¡¨ (Connectivity Matrix)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># elements[i] = [å·¦èŠ‚ç‚¹ç´¢å¼•, å³èŠ‚ç‚¹ç´¢å¼•]</span>
</span></span><span style=display:flex><span>elements <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(NUM_ELEMENTS):
</span></span><span style=display:flex><span>    elements<span style=color:#f92672>.</span>append([i, i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># è½¬ä¸º array æ–¹ä¾¿åç»­ç´¢å¼•</span>
</span></span><span style=display:flex><span>elements <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(elements)
</span></span></code></pre></div><blockquote><p><code>np.linspace(start, stop, num)</code> ç”ŸæˆåŒ…å« <code>num</code> ä¸ªç‚¹çš„ç­‰å·®æ•°åˆ—ï¼ˆé—­åŒºé—´ï¼‰ã€‚è¿™æ˜¯ FEM ç”Ÿæˆç»“æ„åŒ–ç½‘æ ¼æœ€å¸¸ç”¨çš„å‡½æ•°ã€‚</p></blockquote><h3 id=23-å•å…ƒåˆšåº¦çŸ©é˜µä¸å…¨å±€ç»„è£…>2.3 å•å…ƒåˆšåº¦çŸ©é˜µä¸å…¨å±€ç»„è£…<a hidden class=anchor aria-hidden=true href=#23-å•å…ƒåˆšåº¦çŸ©é˜µä¸å…¨å±€ç»„è£…>#</a></h3><p>æ­¤éƒ¨åˆ†æ˜¯ FEM ç®—æ³•æ ¸å¿ƒã€‚</p><blockquote><ol><li><strong>å±€éƒ¨è¿‘ä¼¼</strong>: å‡å®šå•å…ƒå†…éƒ¨å±æ€§å‡åŒ€ï¼Œå–ä¸­ç‚¹é¢ç§¯ $A_{mid}$ è®¡ç®— $k_e$ã€‚</li><li><strong>è‡ªç”±åº¦æ˜ å°„ (DOF Mapping)</strong>:<ul><li>å±€éƒ¨ç´¢å¼• <code>0</code> (å·¦) $\rightarrow$ å…¨å±€ç´¢å¼• <code>node_i</code></li><li>å±€éƒ¨ç´¢å¼• <code>1</code> (å³) $\rightarrow$ å…¨å±€ç´¢å¼• <code>node_j</code></li></ul></li><li><strong>ç´¯åŠ </strong>: å…¨å±€çŸ©é˜µ $K_{global}$ çš„å¯¹åº”ä½ç½®ç´¯åŠ å±€éƒ¨çŸ©é˜µçš„åˆ†é‡ã€‚</li></ol></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># åˆå§‹åŒ–å…¨å±€çŸ©é˜µ (ä½¿ç”¨ç¨ å¯†çŸ©é˜µï¼Œå¤§è§„æ¨¡é—®é¢˜éœ€æ”¹ç”¨ scipy.sparse)</span>
</span></span><span style=display:flex><span>K_global <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>zeros((NUM_NODES, NUM_NODES))
</span></span><span style=display:flex><span>F_global <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>zeros(NUM_NODES)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;å¼€å§‹ç»„è£…åˆšåº¦çŸ©é˜µ...&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> e <span style=color:#f92672>in</span> range(NUM_ELEMENTS):
</span></span><span style=display:flex><span>    <span style=color:#75715e># --- Step 1: è·å–æ‹“æ‰‘ä¿¡æ¯ ---</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># è·å–å½“å‰å•å…ƒè¿æ¥çš„å…¨å±€èŠ‚ç‚¹ç´¢å¼•</span>
</span></span><span style=display:flex><span>    idx_L <span style=color:#f92672>=</span> elements[e, <span style=color:#ae81ff>0</span>]  <span style=color:#75715e># å·¦èŠ‚ç‚¹ Global ID</span>
</span></span><span style=display:flex><span>    idx_R <span style=color:#f92672>=</span> elements[e, <span style=color:#ae81ff>1</span>]  <span style=color:#75715e># å³èŠ‚ç‚¹ Global ID</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># è·å–èŠ‚ç‚¹ç‰©ç†åæ ‡</span>
</span></span><span style=display:flex><span>    x_L <span style=color:#f92672>=</span> nodes[idx_L]
</span></span><span style=display:flex><span>    x_R <span style=color:#f92672>=</span> nodes[idx_R]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># --- Step 2: è®¡ç®—å•å…ƒåˆšåº¦çŸ©é˜µ k_e ---</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># å•å…ƒé•¿åº¦</span>
</span></span><span style=display:flex><span>    Le <span style=color:#f92672>=</span> x_R <span style=color:#f92672>-</span> x_L
</span></span><span style=display:flex><span>    <span style=color:#75715e># å•å…ƒä¸­ç‚¹åæ ‡ -&gt; è®¡ç®—ä¸­ç‚¹é¢ç§¯ (å˜æˆªé¢è¿‘ä¼¼å¤„ç†)</span>
</span></span><span style=display:flex><span>    x_mid <span style=color:#f92672>=</span> (x_L <span style=color:#f92672>+</span> x_R) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2.0</span>
</span></span><span style=display:flex><span>    A_avg <span style=color:#f92672>=</span> get_area(x_mid)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># åˆšåº¦ç³»æ•° k = EA/L</span>
</span></span><span style=display:flex><span>    k_val <span style=color:#f92672>=</span> E_mod <span style=color:#f92672>*</span> A_avg <span style=color:#f92672>/</span> Le
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># å±€éƒ¨åˆšåº¦çŸ©é˜µ (2x2)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># [ k, -k]</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># [-k,  k]</span>
</span></span><span style=display:flex><span>    k_element <span style=color:#f92672>=</span> k_val <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>array([[<span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>]])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># --- Step 3: ç»„è£…åˆ°å…¨å±€çŸ©é˜µ (Scatter) ---</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># æ˜ å°„å…³ç³»:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># local [0, 0] -&gt; global [idx_L, idx_L]</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># local [0, 1] -&gt; global [idx_L, idx_R] ...</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    K_global[idx_L, idx_L] <span style=color:#f92672>+=</span> k_element[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    K_global[idx_L, idx_R] <span style=color:#f92672>+=</span> k_element[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    K_global[idx_R, idx_L] <span style=color:#f92672>+=</span> k_element[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    K_global[idx_R, idx_R] <span style=color:#f92672>+=</span> k_element[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;ç»„è£…å®Œæˆã€‚&#34;</span>)
</span></span></code></pre></div><h3 id=24-æ–½åŠ è¾¹ç•Œæ¡ä»¶-boundary-conditions>2.4 æ–½åŠ è¾¹ç•Œæ¡ä»¶ (Boundary Conditions)<a hidden class=anchor aria-hidden=true href=#24-æ–½åŠ è¾¹ç•Œæ¡ä»¶-boundary-conditions>#</a></h3><blockquote><p>åŸå§‹ $K_{global}$ æ˜¯å¥‡å¼‚çŸ©é˜µï¼ˆè¡Œåˆ—å¼ä¸º 0ï¼‰ï¼Œä»£è¡¨ç»“æ„å­˜åœ¨åˆšä½“ä½ç§»æ¨¡å¼ã€‚å¿…é¡»å¼•å…¥ Dirichlet è¾¹ç•Œæ¡ä»¶æ‰èƒ½æ±‚è§£ã€‚</p></blockquote><blockquote><p>ç›®æ ‡ï¼šå¼ºåˆ¶ $u_{node} = \bar{u}$ã€‚
æ“ä½œï¼š</p><ol><li>å°† $K$ ä¸­å¯¹åº” <strong>è¡Œ</strong> å…¨éƒ¨ç½®é›¶ã€‚</li><li>å°†å¯¹è§’çº¿å…ƒç´  $K_{ii}$ ç½®ä¸º 1ã€‚</li><li>å°† $F$ ä¸­å¯¹åº”å…ƒç´  $F_i$ ç½®ä¸º $\bar{u}$ã€‚
<em>æ³¨ï¼šä¸ºäº†ä¿æŒå¯¹ç§°æ€§ï¼Œé€šå¸¸ä¹Ÿå¯å°†å¯¹åº” <strong>åˆ—</strong> ç½®é›¶ï¼Œä½†è¿™æ­¥å¯¹äºéå¯¹ç§°æ±‚è§£å™¨ä¸æ˜¯å¿…é¡»çš„ã€‚</em></li></ol></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># å¤åˆ¶çŸ©é˜µä»¥ä¿ç•™åŸå§‹æ•°æ®ï¼ˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼‰</span>
</span></span><span style=display:flex><span>K_final <span style=color:#f92672>=</span> K_global<span style=color:#f92672>.</span>copy()
</span></span><span style=display:flex><span>F_final <span style=color:#f92672>=</span> F_global<span style=color:#f92672>.</span>copy()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. æ–½åŠ  Neumann è¾¹ç•Œ (åŠ›è¾¹ç•Œ)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># åœ¨æœ€å³ç«¯èŠ‚ç‚¹ (ç´¢å¼• -1) æ–½åŠ æ‹‰åŠ› P</span>
</span></span><span style=display:flex><span>F_final[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>+=</span> P_load
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. æ–½åŠ  Dirichlet è¾¹ç•Œ (ä½ç§»è¾¹ç•Œ)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># çº¦æŸ: å·¦ç«¯èŠ‚ç‚¹ (ç´¢å¼• 0) ä½ç§»ä¸º 0</span>
</span></span><span style=display:flex><span>fixed_node <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>fixed_val  <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># (1) è¡Œæ¸…é›¶</span>
</span></span><span style=display:flex><span>K_final[fixed_node, :] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># (2) å¯¹è§’çº¿ç½®1</span>
</span></span><span style=display:flex><span>K_final[fixed_node, fixed_node] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># (3) ä¿®æ­£è½½è·é¡¹</span>
</span></span><span style=display:flex><span>F_final[fixed_node] <span style=color:#f92672>=</span> fixed_val
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># (å¯é€‰) å¯¹ç§°åŒ–å¤„ç†ï¼šåˆ—æ¸…é›¶</span>
</span></span><span style=display:flex><span><span style=color:#75715e># æ³¨æ„ï¼šè‹¥æ‰§è¡Œåˆ—æ¸…é›¶ï¼Œéœ€ä¿®æ­£ RHS å‘é‡ä¸­å—è¯¥èŠ‚ç‚¹å½±å“çš„å…¶ä»–é¡¹</span>
</span></span><span style=display:flex><span><span style=color:#75715e># F_final -= K_global[:, fixed_node] * fixed_val </span>
</span></span><span style=display:flex><span><span style=color:#75715e># ä½†ç”±äºæ­¤å¤„ fixed_val=0ï¼Œæ­¤æ­¥å¯çœç•¥ã€‚</span>
</span></span></code></pre></div><blockquote><p><code>array[i, :] = 0</code> è¡¨ç¤ºå°†ç¬¬ <code>i</code> è¡Œçš„æ‰€æœ‰åˆ—å…ƒç´ èµ‹å€¼ä¸º 0ã€‚è¿™æ˜¯ Numpy è¿›è¡ŒçŸ©é˜µæ“ä½œçš„æ ¸å¿ƒè¯­æ³•ã€‚</p></blockquote><h3 id=25-æ±‚è§£ä¸åå¤„ç†>2.5 æ±‚è§£ä¸åå¤„ç†<a hidden class=anchor aria-hidden=true href=#25-æ±‚è§£ä¸åå¤„ç†>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># === æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ Ax = b ===</span>
</span></span><span style=display:flex><span><span style=color:#75715e># U ä¸ºä½ç§»å‘é‡</span>
</span></span><span style=display:flex><span>U <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linalg<span style=color:#f92672>.</span>solve(K_final, F_final)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># === ç†è®ºè§£å¯¹æ¯” (Exact Solution) ===</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å¯¹äºå˜æˆªé¢æ†ï¼Œç†è®ºè§£éœ€ç§¯åˆ†: u(x) = Integral(P / (E*A(x)) dx)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ç®€å•çš„æ•°å€¼ç§¯åˆ†ç”¨äºå¯¹æ¯”</span>
</span></span><span style=display:flex><span>x_fine <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, L_total, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>u_exact <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>zeros_like(x_fine)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, len(x_fine)):
</span></span><span style=display:flex><span>    <span style=color:#75715e># ç®€å•çš„æ¢¯å½¢ç§¯åˆ†</span>
</span></span><span style=display:flex><span>    x_seg <span style=color:#f92672>=</span> x_fine[i]
</span></span><span style=display:flex><span>    <span style=color:#75715e># è¿‘ä¼¼è®¡ç®— u = Integral(P/EA)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># è¿™é‡Œä»…åšç²—ç•¥å¯¹æ¯”ç¤ºæ„</span>
</span></span><span style=display:flex><span>    dx <span style=color:#f92672>=</span> x_fine[i] <span style=color:#f92672>-</span> x_fine[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    mid_A <span style=color:#f92672>=</span> get_area((x_fine[i] <span style=color:#f92672>+</span> x_fine[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    du <span style=color:#f92672>=</span> (P_load <span style=color:#f92672>/</span> (E_mod <span style=color:#f92672>*</span> mid_A)) <span style=color:#f92672>*</span> dx
</span></span><span style=display:flex><span>    u_exact[i] <span style=color:#f92672>=</span> u_exact[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> du
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># === ç»˜å›¾ ===</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ç»˜åˆ¶ FEM ç»“æœ</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(nodes, U, <span style=color:#e6db74>&#39;o-&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;FEM (Numerical)&#39;</span>, linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>, markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ç»˜åˆ¶ç†è®ºè¿‘ä¼¼</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>plot(x_fine, u_exact, <span style=color:#e6db74>&#39;r--&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Theoretical (Approx)&#39;</span>, alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.7</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;1D Variable Cross-section Bar Analysis</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Elements: </span><span style=color:#e6db74>{</span>NUM_ELEMENTS<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;Position x [m]&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;Displacement u [m]&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>, which<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;both&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;--&#39;</span>, alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.6</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>legend()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>tight_layout()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;æœ€å¤§ä½ç§» (FEM): </span><span style=color:#e6db74>{</span>U[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#e6db74>:</span><span style=color:#e6db74>.6e</span><span style=color:#e6db74>}</span><span style=color:#e6db74> m&#34;</span>)
</span></span></code></pre></div><hr><h2 id=3-å¤ä¹ è¦ç‚¹æ€»ç»“>3. å¤ä¹ è¦ç‚¹æ€»ç»“<a hidden class=anchor aria-hidden=true href=#3-å¤ä¹ è¦ç‚¹æ€»ç»“>#</a></h2><h3 id=31-æ ¸å¿ƒç®—æ³•å¤ç›˜>3.1 æ ¸å¿ƒç®—æ³•å¤ç›˜<a hidden class=anchor aria-hidden=true href=#31-æ ¸å¿ƒç®—æ³•å¤ç›˜>#</a></h3><ol><li><strong>ç¦»æ•£åŒ–</strong>ï¼šè¿ç»­ $\rightarrow$ ç¦»æ•£ (<code>linspace</code>, <code>connectivity</code>)ã€‚</li><li><strong>å±€éƒ¨åˆšåº¦</strong>ï¼š$k = \frac{EA}{L}$ï¼Œç‰©ç†å±æ€§åœ¨æ­¤å¤„é€šè¿‡ $A(x)$ å‡½æ•°ç¦»æ•£åŒ–ã€‚</li><li><strong>ç»„è£…æ˜ å°„</strong>ï¼šè¿™æ˜¯ FEM ç¼–ç¨‹æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ã€‚å¿…é¡»æ¸…æ¥šå±€éƒ¨ç´¢å¼•ï¼ˆ0,1ï¼‰å¦‚ä½•å¯¹åº”åˆ°å…¨å±€ç´¢å¼•ï¼ˆ$i, i+1$ï¼‰ã€‚</li><li><strong>è¾¹ç•Œå¤„ç†</strong>ï¼šç†è§£ä¸ºä»€ä¹ˆ $K$ æ˜¯å¥‡å¼‚çš„ï¼Œä»¥åŠç½® 1 æ³•å¦‚ä½•é€šè¿‡æ•°å­¦æ‰‹æ®µæ¶ˆé™¤åˆšä½“ä½ç§»ã€‚</li></ol><h3 id=32-python-ç§‘å­¦è®¡ç®—è¯­æ³•é€ŸæŸ¥>3.2 Python ç§‘å­¦è®¡ç®—è¯­æ³•é€ŸæŸ¥<a hidden class=anchor aria-hidden=true href=#32-python-ç§‘å­¦è®¡ç®—è¯­æ³•é€ŸæŸ¥>#</a></h3><table><thead><tr><th style=text-align:left>è¯­æ³•</th><th style=text-align:left>è¯´æ˜</th><th style=text-align:left>ç¤ºä¾‹</th></tr></thead><tbody><tr><td style=text-align:left><code>np.zeros((n, m))</code></td><td style=text-align:left>åˆå§‹åŒ–å…¨é›¶çŸ©é˜µ</td><td style=text-align:left><code>K = np.zeros((5,5))</code></td></tr><tr><td style=text-align:left><code>np.linspace(a, b, n)</code></td><td style=text-align:left>ç”Ÿæˆç­‰å·®æ•°åˆ—</td><td style=text-align:left>ç½‘æ ¼èŠ‚ç‚¹ç”Ÿæˆ</td></tr><tr><td style=text-align:left><code>enumerate(list)</code></td><td style=text-align:left>éå†åˆ—è¡¨åŒæ—¶è·å–ç´¢å¼•</td><td style=text-align:left><code>for i, val in enumerate(nodes):</code></td></tr><tr><td style=text-align:left><code>array[-1]</code></td><td style=text-align:left>ç´¢å¼•å€’æ•°ç¬¬ä¸€ä¸ªå…ƒç´ </td><td style=text-align:left>è·å–æœ«ç«¯èŠ‚ç‚¹</td></tr><tr><td style=text-align:left><code>array.copy()</code></td><td style=text-align:left><strong>æ·±æ‹·è´</strong></td><td style=text-align:left><code>K_bc = K.copy()</code> (ç›´æ¥èµ‹å€¼æ˜¯å¼•ç”¨ï¼Œä¿®æ”¹ä¼šå½±å“åŸæ•°ç»„)</td></tr><tr><td style=text-align:left><code>np.linalg.solve</code></td><td style=text-align:left>è§£çº¿æ€§æ–¹ç¨‹ç»„</td><td style=text-align:left><code>x = solve(A, b)</code> (å†…éƒ¨ä½¿ç”¨ LAPACKï¼Œé«˜æ•ˆ)</td></tr></tbody></table><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://example.org/tags/fem/>FEM</a></li><li><a href=https://example.org/tags/python/>Python</a></li><li><a href=https://example.org/tags/numericalanalysis/>NumericalAnalysis</a></li><li><a href=https://example.org/tags/structure/>Structure</a></li><li><a href=https://example.org/tags/review/>Review</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://example.org/>Chaos Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>